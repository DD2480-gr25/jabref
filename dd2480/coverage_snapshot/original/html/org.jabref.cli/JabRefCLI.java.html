<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JabRefCLI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JabRef</a> &gt; <a href="index.source.html" class="el_package">org.jabref.cli</a> &gt; <span class="el_source">JabRefCLI.java</span></div><h1>JabRefCLI.java</h1><pre class="source lang-java linenums">package org.jabref.cli;

import java.util.List;

import org.jabref.gui.Globals;
import org.jabref.logic.l10n.Localization;

import org.apache.commons.cli.CommandLine;
import org.apache.commons.cli.DefaultParser;
import org.apache.commons.cli.HelpFormatter;
import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;
import org.apache.commons.cli.ParseException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class JabRefCLI {

    private static final int WIDTH = 100; // Number of characters per line
<span class="fc" id="L20">    private static final Logger LOGGER = LoggerFactory.getLogger(JabRefCLI.class);</span>
    private final CommandLine cl;
    private final List&lt;String&gt; leftOver;

<span class="fc" id="L24">    public JabRefCLI(String[] args) throws ParseException {</span>
<span class="fc" id="L25">        Options options = getOptions();</span>

<span class="fc" id="L27">        this.cl = new DefaultParser().parse(options, args, true);</span>
<span class="fc" id="L28">        this.leftOver = cl.getArgList();</span>
<span class="fc" id="L29">    }</span>

    public static String getExportMatchesSyntax() {
<span class="nc" id="L32">        return String.format(&quot;[%s]searchTerm,outputFile:%s[,%s]&quot;,</span>
<span class="nc" id="L33">                Localization.lang(&quot;field&quot;),</span>
<span class="nc" id="L34">                Localization.lang(&quot;file&quot;),</span>
<span class="nc" id="L35">                Localization.lang(&quot;exportFormat&quot;));</span>
    }

    public boolean isHelp() {
<span class="nc" id="L39">        return cl.hasOption(&quot;help&quot;);</span>
    }

    public boolean isShowVersion() {
<span class="nc" id="L43">        return cl.hasOption(&quot;version&quot;);</span>
    }

    public boolean isBlank() {
<span class="nc" id="L47">        return cl.hasOption(&quot;blank&quot;);</span>
    }

    public boolean isLoadSession() {
<span class="nc" id="L51">        return cl.hasOption(&quot;loads&quot;);</span>
    }

    public boolean isDisableGui() {
<span class="fc" id="L55">        return cl.hasOption(&quot;nogui&quot;);</span>
    }

    public boolean isPreferencesExport() {
<span class="nc" id="L59">        return cl.hasOption(&quot;prexp&quot;);</span>
    }

    public String getPreferencesExport() {
<span class="fc" id="L63">        return cl.getOptionValue(&quot;prexp&quot;, &quot;jabref_prefs.xml&quot;);</span>
    }

    public boolean isPreferencesImport() {
<span class="nc" id="L67">        return cl.hasOption(&quot;primp&quot;);</span>
    }

    public String getPreferencesImport() {
<span class="nc" id="L71">        return cl.getOptionValue(&quot;primp&quot;, &quot;jabref_prefs.xml&quot;);</span>
    }

    public boolean isPreferencesReset() {
<span class="nc" id="L75">        return cl.hasOption(&quot;prdef&quot;);</span>
    }

    public String getPreferencesReset() {
<span class="nc" id="L79">        return cl.getOptionValue(&quot;prdef&quot;);</span>
    }

    public boolean isFileExport() {
<span class="nc" id="L83">        return cl.hasOption(&quot;output&quot;);</span>
    }

    public String getFileExport() {
<span class="fc" id="L87">        return cl.getOptionValue(&quot;output&quot;);</span>
    }

    public boolean isBibtexImport() {
<span class="fc" id="L91">        return cl.hasOption(&quot;importBibtex&quot;);</span>
    }

    public String getBibtexImport() {
<span class="fc" id="L95">        return cl.getOptionValue(&quot;importBibtex&quot;);</span>
    }

    public boolean isFileImport() {
<span class="nc" id="L99">        return cl.hasOption(&quot;import&quot;);</span>
    }

    public String getFileImport() {
<span class="fc" id="L103">        return cl.getOptionValue(&quot;import&quot;);</span>
    }

    public boolean isAuxImport() {
<span class="nc" id="L107">        return cl.hasOption(&quot;aux&quot;);</span>
    }

    public String getAuxImport() {
<span class="nc" id="L111">        return cl.getOptionValue(&quot;aux&quot;);</span>
    }

    public boolean isImportToOpenBase() {
<span class="nc" id="L115">        return cl.hasOption(&quot;importToOpen&quot;);</span>
    }

    public String getImportToOpenBase() {
<span class="nc" id="L119">        return cl.getOptionValue(&quot;importToOpen&quot;);</span>
    }

    public boolean isDebugLogging() {
<span class="nc" id="L123">        return cl.hasOption(&quot;debug&quot;);</span>
    }

    public boolean isFetcherEngine() {
<span class="nc" id="L127">        return cl.hasOption(&quot;fetch&quot;);</span>
    }

    public String getFetcherEngine() {
<span class="nc" id="L131">        return cl.getOptionValue(&quot;fetch&quot;);</span>
    }

    public boolean isExportMatches() {
<span class="nc" id="L135">        return cl.hasOption(&quot;exportMatches&quot;);</span>
    }

    public String getExportMatches() {
<span class="nc" id="L139">        return cl.getOptionValue(&quot;exportMatches&quot;);</span>
    }

    public boolean isGenerateCitationKeys() {
<span class="nc" id="L143">        return cl.hasOption(&quot;generateCitationKeys&quot;);</span>
    }

    public boolean isAutomaticallySetFileLinks() {
<span class="nc" id="L147">        return cl.hasOption(&quot;automaticallySetFileLinks&quot;);</span>
    }

    public boolean isWriteXMPtoPdf() {
<span class="nc" id="L151">        return cl.hasOption(&quot;writeXMPtoPdf&quot;);</span>
    }

    public boolean isEmbeddBibfileInPdf() {
<span class="nc" id="L155">        return cl.hasOption(&quot;embeddBibfileInPdf&quot;);</span>
    }

    public boolean isWriteMetadatatoPdf() {
<span class="nc" id="L159">        return cl.hasOption(&quot;writeMetadatatoPdf&quot;);</span>
    }

    public String getWriteMetadatatoPdf() {
<span class="nc bnc" id="L163" title="All 2 branches missed.">        return cl.hasOption(&quot;writeMetadatatoPdf&quot;) ? cl.getOptionValue(&quot;writeMetadatatoPdf&quot;) :</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                cl.hasOption(&quot;writeXMPtoPdf&quot;) ? cl.getOptionValue(&quot;writeXMPtoPdf&quot;) :</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">                cl.hasOption(&quot;embeddBibfileInPdf&quot;) ? cl.getOptionValue(&quot;embeddBibfileInPdf&quot;) : null;</span>
    }

    private static Options getOptions() {
<span class="fc" id="L169">        Options options = new Options();</span>

        // boolean options
<span class="fc" id="L172">        options.addOption(&quot;h&quot;, &quot;help&quot;, false, Localization.lang(&quot;Display help on command line options&quot;));</span>
<span class="fc" id="L173">        options.addOption(&quot;n&quot;, &quot;nogui&quot;, false, Localization.lang(&quot;No GUI. Only process command line options&quot;));</span>
<span class="fc" id="L174">        options.addOption(&quot;asfl&quot;, &quot;automaticallySetFileLinks&quot;, false, Localization.lang(&quot;Automatically set file links&quot;));</span>
<span class="fc" id="L175">        options.addOption(&quot;g&quot;, &quot;generateCitationKeys&quot;, false, Localization.lang(&quot;Regenerate all keys for the entries in a BibTeX file&quot;));</span>
<span class="fc" id="L176">        options.addOption(&quot;b&quot;, &quot;blank&quot;, false, Localization.lang(&quot;Do not open any files at startup&quot;));</span>
<span class="fc" id="L177">        options.addOption(&quot;v&quot;, &quot;version&quot;, false, Localization.lang(&quot;Display version&quot;));</span>
<span class="fc" id="L178">        options.addOption(null, &quot;debug&quot;, false, Localization.lang(&quot;Show debug level messages&quot;));</span>

        // The &quot;-console&quot; option is handled by the install4j launcher
<span class="fc" id="L181">        options.addOption(null, &quot;console&quot;, false, Localization.lang(&quot;Show console output (only when the launcher is used)&quot;));</span>

<span class="fc" id="L183">        options.addOption(Option</span>
<span class="fc" id="L184">                .builder(&quot;i&quot;)</span>
<span class="fc" id="L185">                .longOpt(&quot;import&quot;)</span>
<span class="fc" id="L186">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Import file&quot;), &quot;-i library.bib&quot;))</span>
<span class="fc" id="L187">                .hasArg()</span>
<span class="fc" id="L188">                .argName(&quot;FILE[,FORMAT]&quot;)</span>
<span class="fc" id="L189">                .build());</span>

<span class="fc" id="L191">        options.addOption(Option</span>
<span class="fc" id="L192">                .builder()</span>
<span class="fc" id="L193">                .longOpt(&quot;importToOpen&quot;)</span>
<span class="fc" id="L194">                .desc(Localization.lang(&quot;Same as --import, but will be imported to the opened tab&quot;))</span>
<span class="fc" id="L195">                .hasArg()</span>
<span class="fc" id="L196">                .argName(&quot;FILE[,FORMAT]&quot;)</span>
<span class="fc" id="L197">                .build());</span>

<span class="fc" id="L199">        options.addOption(Option</span>
<span class="fc" id="L200">                .builder(&quot;ib&quot;)</span>
<span class="fc" id="L201">                .longOpt(&quot;importBibtex&quot;)</span>
<span class="fc" id="L202">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Import BibTeX&quot;), &quot;-ib @article{entry}&quot;))</span>
<span class="fc" id="L203">                .hasArg()</span>
<span class="fc" id="L204">                .argName(&quot;BIBTEXT_STRING&quot;)</span>
<span class="fc" id="L205">                .build());</span>

<span class="fc" id="L207">        options.addOption(Option</span>
<span class="fc" id="L208">                .builder(&quot;o&quot;)</span>
<span class="fc" id="L209">                .longOpt(&quot;output&quot;)</span>
<span class="fc" id="L210">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Export an input to a file&quot;), &quot;-i db.bib -o db.htm,html&quot;))</span>
<span class="fc" id="L211">                .hasArg()</span>
<span class="fc" id="L212">                .argName(&quot;FILE[,FORMAT]&quot;)</span>
<span class="fc" id="L213">                .build());</span>

<span class="fc" id="L215">        options.addOption(Option</span>
<span class="fc" id="L216">                .builder(&quot;m&quot;)</span>
<span class="fc" id="L217">                .longOpt(&quot;exportMatches&quot;)</span>
<span class="fc" id="L218">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Matching&quot;), &quot;-i db.bib -m author=Newton,search.htm,html&quot;))</span>
<span class="fc" id="L219">                .hasArg()</span>
<span class="fc" id="L220">                .argName(&quot;QUERY,FILE[,FORMAT]&quot;)</span>
<span class="fc" id="L221">                .build());</span>

<span class="fc" id="L223">        options.addOption(Option</span>
<span class="fc" id="L224">                .builder(&quot;f&quot;)</span>
<span class="fc" id="L225">                .longOpt(&quot;fetch&quot;)</span>
<span class="fc" id="L226">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Run fetcher&quot;), &quot;-f Medline/PubMed:cancer&quot;))</span>
<span class="fc" id="L227">                .hasArg()</span>
<span class="fc" id="L228">                .argName(&quot;FETCHER:QUERY&quot;)</span>
<span class="fc" id="L229">                .build());</span>

<span class="fc" id="L231">        options.addOption(Option</span>
<span class="fc" id="L232">                .builder(&quot;a&quot;)</span>
<span class="fc" id="L233">                .longOpt(&quot;aux&quot;)</span>
<span class="fc" id="L234">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Sublibrary from AUX to BibTeX&quot;), &quot;-a thesis.aux,new.bib&quot;))</span>
<span class="fc" id="L235">                .hasArg()</span>
<span class="fc" id="L236">                .argName(&quot;FILE[.aux],FILE[.bib] FILE&quot;)</span>
<span class="fc" id="L237">                .build());</span>

<span class="fc" id="L239">        options.addOption(Option</span>
<span class="fc" id="L240">                .builder(&quot;x&quot;)</span>
<span class="fc" id="L241">                .longOpt(&quot;prexp&quot;)</span>
<span class="fc" id="L242">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Export preferences to a file&quot;), &quot;-x prefs.xml&quot;))</span>
<span class="fc" id="L243">                .hasArg()</span>
<span class="fc" id="L244">                .argName(&quot;[FILE]&quot;)</span>
<span class="fc" id="L245">                .build());</span>

<span class="fc" id="L247">        options.addOption(Option</span>
<span class="fc" id="L248">                .builder(&quot;p&quot;)</span>
<span class="fc" id="L249">                .longOpt(&quot;primp&quot;)</span>
<span class="fc" id="L250">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Import preferences from a file&quot;), &quot;-p prefs.xml&quot;))</span>
<span class="fc" id="L251">                .hasArg()</span>
<span class="fc" id="L252">                .argName(&quot;[FILE]&quot;)</span>
<span class="fc" id="L253">                .build());</span>

<span class="fc" id="L255">        options.addOption(Option</span>
<span class="fc" id="L256">                .builder(&quot;d&quot;)</span>
<span class="fc" id="L257">                .longOpt(&quot;prdef&quot;)</span>
<span class="fc" id="L258">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Reset preferences&quot;), &quot;-d mainFontSize,newline' or '-d all&quot;))</span>
<span class="fc" id="L259">                .hasArg()</span>
<span class="fc" id="L260">                .argName(&quot;KEY1[,KEY2][,KEYn] | all&quot;)</span>
<span class="fc" id="L261">                .build());</span>

<span class="fc" id="L263">        options.addOption(Option</span>
<span class="fc" id="L264">                .builder()</span>
<span class="fc" id="L265">                .longOpt(&quot;writeXMPtoPdf&quot;)</span>
<span class="fc" id="L266">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Write BibTeXEntry as XMP metadata to PDF.&quot;), &quot;-w pathToMyOwnPaper.pdf&quot;))</span>
<span class="fc" id="L267">                .hasArg()</span>
<span class="fc" id="L268">                .argName(&quot;CITEKEY1[,CITEKEY2][,CITEKEYn] | PDF1[,PDF2][,PDFn] | all&quot;)</span>
<span class="fc" id="L269">                .build());</span>

<span class="fc" id="L271">        options.addOption(Option</span>
<span class="fc" id="L272">                .builder()</span>
<span class="fc" id="L273">                .longOpt(&quot;embeddBibfileInPdf&quot;)</span>
<span class="fc" id="L274">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Embed BibTeXEntry in PDF.&quot;), &quot;-w pathToMyOwnPaper.pdf&quot;))</span>
<span class="fc" id="L275">                .hasArg()</span>
<span class="fc" id="L276">                .argName(&quot;CITEKEY1[,CITEKEY2][,CITEKEYn] | PDF1[,PDF2][,PDFn] | all&quot;)</span>
<span class="fc" id="L277">                .build());</span>

<span class="fc" id="L279">        options.addOption(Option</span>
<span class="fc" id="L280">                .builder(&quot;w&quot;)</span>
<span class="fc" id="L281">                .longOpt(&quot;writeMetadatatoPdf&quot;)</span>
<span class="fc" id="L282">                .desc(String.format(&quot;%s: '%s'&quot;, Localization.lang(&quot;Write BibTeXEntry as metadata to PDF.&quot;), &quot;-w pathToMyOwnPaper.pdf&quot;))</span>
<span class="fc" id="L283">                .hasArg()</span>
<span class="fc" id="L284">                .argName(&quot;CITEKEY1[,CITEKEY2][,CITEKEYn] | PDF1[,PDF2][,PDFn] | all&quot;)</span>
<span class="fc" id="L285">                .build());</span>

<span class="fc" id="L287">        return options;</span>
    }

    public void displayVersion() {
<span class="nc" id="L291">        System.out.println(getVersionInfo());</span>
<span class="nc" id="L292">    }</span>

    public static void printUsage() {
<span class="nc" id="L295">        String header = &quot;&quot;;</span>

<span class="nc" id="L297">        String importFormats = Globals.IMPORT_FORMAT_READER.getImportFormatList();</span>
<span class="nc" id="L298">        String importFormatsList = String.format(&quot;%s:%n%s%n&quot;, Localization.lang(&quot;Available import formats&quot;), importFormats);</span>

<span class="nc" id="L300">        String outFormats = Globals.exportFactory.getExportersAsString(70, 20, &quot;&quot;);</span>
<span class="nc" id="L301">        String outFormatsList = String.format(&quot;%s: %s%n&quot;, Localization.lang(&quot;Available export formats&quot;), outFormats);</span>

<span class="nc" id="L303">        String footer = '\n' + importFormatsList + outFormatsList + &quot;\nPlease report issues at https://github.com/JabRef/jabref/issues.&quot;;</span>

<span class="nc" id="L305">        HelpFormatter formatter = new HelpFormatter();</span>
<span class="nc" id="L306">        formatter.printHelp(WIDTH, &quot;jabref [OPTIONS] [BIBTEX_FILE]\n\nOptions:&quot;, header, getOptions(), footer, true);</span>
<span class="nc" id="L307">    }</span>

    private String getVersionInfo() {
<span class="nc" id="L310">        return String.format(&quot;JabRef %s&quot;, Globals.BUILD_INFO.version);</span>
    }

    public List&lt;String&gt; getLeftOver() {
<span class="fc" id="L314">        return leftOver;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>